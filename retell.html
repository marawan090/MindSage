<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Retell Agent with SDK</title>
</head>
<body>
  <h1>ğŸ™ï¸ Retell Agent Ø¯Ø§Ø®Ù„ Ù…ÙˆÙ‚Ø¹Ùƒ</h1>

  <button onclick="joinCall()">â–¶ï¸ Ø¨Ø¯Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©</button>
  <button onclick="leaveCall()">â¹ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù„Ø³Ø©</button>

  <p id="status">âšª Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ´ØºÙŠÙ„</p>

  <!-- Step 1: Include Retell SDK -->
  <script src="https://cdn.retellai.com/web-sdk/index.min.js"></script>

  <script>
    // Step 2: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Agent ÙˆØ§Ù„Ù…ÙØªØ§Ø­
    const agentId = "agent_ac97619bfb93997ccf71cff3d5"; // â† ØºÙŠØ±Ù‡ Ø¨Ù€ Agent ID Ø¨ØªØ§Ø¹Ùƒ
    const apiKey = "key_9d940c8b806dd4757857040e9e74";  // â† ØºÙŠØ±Ù‡ Ø¨Ù…ÙØªØ§Ø­Ùƒ Ø§Ù„Ø³Ø±ÙŠ

    let callId = null;
    let webCall = null;

    // Step 3: Ø¨Ø¯Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©
    async function joinCall() {
      document.getElementById("status").innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø¨Ø¯Ø¡ Ø§Ù„Ø¬Ù„Ø³Ø©...";

      try {
        // Step 4: Ø£Ù†Ø´Ø¦ Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ù…Ù† API
        const response = await fetch("https://api.retellai.com/v2/create-web-call", {
          method: "POST",
          headers: {
            "Authorization": `Bearer ${apiKey}`,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            agent_id: agentId
          })
        });

        const data = await response.json();
        console.log("ğŸ¯ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Retell:", data);

        if (!data.call_id) {
          document.getElementById("status").innerText = "âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ call_id.";
          return;
        }

        callId = data.call_id;

        // Step 5: Ø§Ù†Ø¶Ù… Ù„Ù„Ù…ÙƒØ§Ù„Ù…Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… SDK
        webCall = await window.retellWebSDK.joinCall({
          callId,
          enableLocalAudioPlayback: true // ÙŠØ³Ù…Ø­ Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹
        });

        document.getElementById("status").innerText = "ğŸŸ¢ Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ø¯Ø£Øª Ø¨Ù†Ø¬Ø§Ø­.";
        console.log("âœ… Ø§Ù„Ø¬Ù„Ø³Ø© Ø¨Ø¯Ø£Øª");
      } catch (error) {
        console.error("âŒ Ø®Ø·Ø£:", error);
        document.getElementById("status").innerText = "âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„.";
      }
    }

    // Step 6: Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¬Ù„Ø³Ø©
    async function leaveCall() {
      if (webCall) {
        await webCall.leaveCall();
        document.getElementById("status").innerText = "ğŸ”´ Ø§Ù„Ø¬Ù„Ø³Ø© ØªÙˆÙ‚ÙØª.";
        console.log("â›” ØªÙ… Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù…ÙƒØ§Ù„Ù…Ø©");
      }
    }
  </script>
</body>
</html>
